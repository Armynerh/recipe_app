<h1><%= @recipe.name %></h1>
<% if current_user == @recipe.user || @recipe.public %>
  <p>
    <strong>Preparation Time:</strong> <%= @recipe.preparation_time %> minutes<br>
    <strong>Cooking Time:</strong> <%= @recipe.cooking_time %> minutes<br>
    <strong>Public:</strong> <%= @recipe.public ? 'Yes' : 'No' %><br>
  </p>
  <%= button_to toggle_public_recipe_path(@recipe), method: :post, class: @recipe.public ? 'public' : 'private' do %>
    <%= @recipe.public ? 'Make Private' : 'Make Public' %>
  <% end %>

  <% if current_user == @recipe.user %>
    <%= link_to 'Add Ingredients', new_recipe_recipe_food_path(@recipe), class: 'btn-link' %>
    <table>
      <thead>
        <tr>
          <th>Food</th>
          <th>Quantity</th>
          <th>Value</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <% @recipe.recipe_foods.each do |recipe_food| %>
          <tr>
            <td><%= recipe_food.food.name %></td>
            <td><%= recipe_food.quantity %></td>
            <td><%= number_to_currency(recipe_food.quantity * recipe_food.food.price) %></td>
            <% if recipe_food.recipe.user_id == current_user.id%>
              <td>
                <%= link_to "Edit this food", edit_food_path(recipe_food.food_id), class: "btn-link" %> 
                <%= button_to "Delete", [@recipe, recipe_food], method: :delete, class: "border border-0 text-decoration-underline text-primary" %>
              <td>
            <% end %>
          </tr>
        <% end %>
      </tbody>
    </table>
  <% end %>
<% else %>
  <p>This recipe is private.</p>
<% end %>
<%= link_to 'Back', recipes_path %>
